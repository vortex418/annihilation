<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="/annihilation/styles.css">
		<link rel="stylesheet" href="/annihilation/libraries/font-awesome-4.css">
		<title>Annihilation [version]</title> 
		<link href="/annihilation/assets/icon.png" rel="icon" type="image/png">
		<style>
			button{font-size:15px}
			.game{position:fixed;left:0%;top:0%;width:100%;height:100%;font-size:15px;background-color:#000;z-index:0}
			#nav_icon-settings:hover{cursor:pointer;}
			.content{position:fixed;left:10%;top:10%;width:80%;height:80%}
			#scene_view-map_button:disabled:hover{cursor:not-allowed}
			.fa-times-circle:hover{cursor:pointer;}
			.fa-arrow-circle-o-up:hover{cursor:pointer;}
			.fa-info-circle:hover{cursor:pointer;}
		</style>
	</head>
	<body>
		<a id="download_link" class="hidden" style="position:absolute;left:60%;top:480px;"><button>Save Game</button></a>
		<input id="scene_menu-load_upload" type="file"  style="display:none;">
		<input id="namesave" class="hidden" type="text" style="position:absolute;left:40%;top:47.5%;width:20%;height:5%;">
		<audio id = "audio"><source src="" type="audio/mp3"></audio>
		<div id="scene_menu-main" class="game" style="background-image:url('/annihilation/assets/beta/menu.png');background-size:cover;background-repeat:no-repeat;">
			<h1 style="font-family:azonix,sans-serif;font-size:60px;position:absolute;top:15%;left:25%;width:50%;"><center>Annihilation</center></h1>
			<button id="scene_menu-main_button-new" style="position:fixed;left:37.5%;top:45%;width:25%;height:8%;">New Game</button>
			<button id="scene_menu-main_button-load" style="position:fixed;left:37.5%;top:60%;width:25%;height:8%;">Load Game</button>
			<button id="scene_menu-main_button-exit" style="position:fixed;left:37.5%;top:75%;width:25%;height:8%;">Exit Game</button>
		</div>
		<div id="scene_menu-save" class="game hidden">
			<input id="scene_menu-save_input" placeholder="save name" style="position:fixed;left:37.5%;top:47.5%;width:25%;height:5%;">
			<button id="scene_menu-save_button" style="position:fixed;left:42.5%;top:57.5%;width:15%;height:5%;">Start</button>
		</div>
		<div id="scene_menu-load" class="game hidden">
			<div id="scene_menu-load_content" class="overlay" style="position:fixed;left:10%;top:10%;width:80%;height:65%;overflow:scroll"></div>
			<button id="scene_menu-load_button-new" style="position:fixed;left:10%;top:80%;width:26.6%;height:7.5%;">New</button>
			<button id="scene_menu-load_button-play" style="position:fixed;left:36.6%;top:80%;width:26.6%;height:7.5%;">Play</button>	
			<button id="scene_menu-load_button-delete" style="position:fixed;left:63.2%;top:80%;width:26.6%;height:7.5%;">Delete</button>
			<button id="scene_menu-load_button-back" style="position:fixed;left:10%;top:90%;width:26.6%;height:7.5%;">Back</button>
			<button id="scene_menu-load_button-upload" style="position:fixed;left:36.6%;top:90%;width:26.6%;height:7.5%;">Upload</button>
			<button id="scene_menu-load_button-download" style="position:fixed;left:63.2%;top:90%;width:26.6%;height:7.5%;">Download</button>
		</div>
		<div id="scene_tips" class="game hidden">
			<ul id="scene_tips_content" style="position:fixed;left:25%;top:20%;width:50%;height:60%;border:0;list-style:none;text-align:center;">
				<li><p><br>Build ships in the shipyard!</p></li>
				<li><p><br>Use the labratory to buff your ships abilities!</p></li>
				<li><p><br>Attack planets to get rewards!</p></li>
				<li><p><br>Collect taxes to get resources, though only 10 per game!</p></li>
			</ul>
			<button id="scene_tips_button" style="position:fixed;left:40%;top:75%;width:20%;height:7.5%;">Start the Game</button>
		</div>
		<div id="scene_view-map" class="background hidden" style="position:fixed;left:10%;top:10%;width:80%;height:80%;z-index:3;">
			<center/>
			<i id="scene_view-map_i" class="fa fa-times-circle" style="position:absolute;left:95%;top:1%;font-size:35px;"></i>
			<p id="scene_view-map_p" style="position:absolute;left:30%;top:60%;font-size:20px;"></p>
			<button id="scene_view-map_button" style="position:absolute;left:30%;top:80%;width:40%;height:10%">Attack</button>
		</div>
		<div id="overlay_dev_map" class="background hidden" style="position:fixed;left:80%;top:7.5%;width:20%;height:15%;z-index:2;">
			<input id="overlay_dev_map_input" style="position:absolute;left:5%;top:5%;width:90%;height:20%;">
			<button id="overlay_dev_map_button" style="position:absolute;left:5%;top:50%;width:90%;height:30%;">Select Planet</button>
		</div>
		<div id="scene_view-battle" class="hidden" style="z-index:3">
			<button id="scene_view-battle_button" style="position:fixed;left:1%;top:1%;width:10%;height:5%">Surrender</button>
			<div id="scene_view-battle_content" class="content background" style="position:fixed;left:12%;top:1%;width:20%;height:5%">
				<svg id="scene_view-battle_content_svg" width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none">
					<rect x="10" y="10" width="80" height="30" fill="rgb(200,200,214)" stroke="rgb(200,200,214)"/>
					<rect x="10" y="60" width="80" height="30" fill="rgb(200,200,214)" stroke="rgb(200,200,214)"/>
					<rect id="scene_view-battle_content_svg_ship-health" x="10" y="10" width="80" height="30" fill="rgb(0,255,0)"/>
					<rect id="scene_view-battle_content_svg_ship-shields" x="10" y="10" width="80" height="30" fill="rgb(0,255,255)"/>
					<rect id="scene_view-battle_content_svg_enemy-health" x="10" y="60" width="80" height="30" fill="rgb(255,0,0)"/>
					<rect id="scene_view-battle_content_svg_enemy-shields" x="10" y="60" width="80" height="30" fill="rgb(128,64,192)"/>
    			</svg>
				<div id="scene_view-battle_content_advanced" class="hidden background" style="position:fixed;left:33%;top:1%;width:20%;height:5%">
					<p id="scene_view-battle_content_advanced_ship" style="position:absolute;left:10%;top:-55%;font-size:15px"></p>
					<p id="scene_view-battle_content_advanced_enemy" style="position:absolute;left:10%;top:-5%;font-size:15px"></p>
				</div>
			</div>
		</div>
		<div id="scene_view-report" class="background hidden" style="position:fixed;left:10%;top:10%;width:80%;height:80%;z-index:2;">
			<center/>
				<i id="scene_view-report_i" class="fa fa-times-circle" style="position:absolute;left:95%;top:1%;font-size:35px;"></i>
				<p id="scene_view-report_p" style="position:absolute;left:30%;top:40%;font-size:20px;"></p>
				<button id="scene_view-report_button" style="position:absolute;left:30%;top:80%;width:40%;height:10%">Accept</button>
		</div>
		<canvas id="mycanvas" class="hidden" style="position:fixed;left:0%;top:7.5%;width:100%;height:92.5%;z-index:1;"></canvas>
		<div id="scene_view-yard" class="game hidden" style="">
			<div id="scene_view-yard_content" class="content background" style="">
				<button id="scene_view-yard_content_tax-button" style="position:absolute;left:40%;top:33%;width:20%;height:5%;">Collect Taxes</button>
				<button id="scene_view-yard_content_corvette_button-new" style="position:absolute;left:5%;top:40%;width:40%;height:10%">Corvette</button>
				<button id="scene_view-yard_content_frigate_button-new" style="position:absolute;left:5%;top:60%;width:40%;height:10%">Frigate</button>
				<button id="scene_view-yard_content_crusier_button-new" style="position:absolute;left:5%;top:80%;width:40%;height:10%">Crusier</button>
				<button id="scene_view-yard_content_destroyer_button-new" style="position:absolute;left:55%;top:40%;width:40%;height:10%">Destroyer</button>
				<button id="scene_view-yard_content_battleship_button-new" style="position:absolute;left:55%;top:60%;width:40%;height:10%">Battleship</button>
				<button id="scene_view-yard_content_dreadnought_button-new" style="position:absolute;left:55%;top:80%;width:40%;height:10%">Dreadnought</button>
				<i id="scene_view-yard_content_corvette_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:8%;top:42.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_frigate_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:8%;top:62.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_crusier_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:8%;top:82.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_destroyer_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:58%;top:42.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_battleship_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:58%;top:62.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_dreadnought_button-up" class="fa fa-arrow-circle-o-up" aria-hidden="true" style="position:absolute;left:58%;top:82.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_corvette_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:39%;top:42.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_frigate_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:39%;top:62.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_crusier_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:39%;top:82.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_destroyer_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:89%;top:42.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_battleship_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:89%;top:62.5%;font-size:25px;"></i>
				<i id="scene_view-yard_content_dreadnought_button-i" class="fa fa-info-circle" aria-hidden="true" style="position:absolute;left:89%;top:82.5%;font-size:25px;"></i>
				<div id="scene_view-yard_content_resources" style="position:absolute;left:10%;top:10%;width:80%;height:20%;">
					<p id="scene_view-yard_content_resources_metal" style="position:absolute;left:5%;top:-30%;max-width:45%;max-height:45%;font-size:30px;"></p>
					<p id="scene_view-yard_content_resources_minerals" style="position:absolute;left:55%;top:-30%;max-width:45%;max-height:45%;font-size:30px;"></p>
					<p id="scene_view-yard_content_resources_fuel" style="position:absolute;left:5%;top:10%;max-width:45%;max-height:45%;font-size:30px;"></p>
					<p id="scene_view-yard_content_resources_tax" style="position:absolute;left:55%;top:10%;max-width:45%;max-height:45%;font-size:30px;"></p>
				</div>
			</div>
		</div>
		<div id="scene_view-lab" class="game hidden">
			<div id="scene_view-lab_content" class="background" style="position:fixed;left:10%;top:10%;width:80%;height:80%">
				<p id="scene_view-lab_content_points" style="position:absolute;left:30%;top:0%;max-width:40%;max-height:15%;font-size:30px;"></p>
				<button id="scene_view-lab_content_armor-button" style="position:absolute;left:10%;top:25%;width:20%;height:5%;">Armor</button>
				<button id="scene_view-lab_content_laser-button" style="position:absolute;left:10%;top:50%;width:20%;height:5%;">Laser</button>
				<button id="scene_view-lab_content_reload-button" style="position:absolute;left:10%;top:75%;width:20%;height:5%;">Reload</button>
				<button id="scene_view-lab_content_construction-button" style="position:absolute;left:40%;top:37.5%;width:20%;height:5%;">Construction</button>
				<button id="scene_view-lab_content_shields-button" style="position:absolute;left:40%;top:25%;width:20%;height:5%;">Shields</button>
				<button id="scene_view-lab_content_missle-button" style="position:absolute;left:40%;top:50%;width:20%;height:5%;">Missle</button>
				<button id="scene_view-lab_content_recharge-button" style="position:absolute;left:40%;top:75%;width:20%;height:5%;">Recharge</button>
				<button id="scene_view-lab_content_salvage-button" style="position:absolute;left:70%;top:37.5%;width:20%;height:5%;">Salvage</button>
				<button id="scene_view-lab_content_tax-button" style="position:absolute;left:40%;top:15%;width:20%;height:5%;">Collect Taxes</button>
				<i id="scene_view-lab_content_construction-icon" class="fa fa-lock" style="position:absolute;left:42%;top:38%;font-size:20px;"></i>
				<i id="scene_view-lab_content_shields-icon" class="fa fa-lock" style="position:absolute;left:42%;top:25.5%;font-size:20px;"></i>
				<i id="scene_view-lab_content_missle-icon" class="fa fa-lock" style="position:absolute;left:42%;top:50.5%;font-size:20px;"></i>
				<i id="scene_view-lab_content_recharge-icon" class="fa fa-lock" style="position:absolute;left:42%;top:75.5%;font-size:20px;"></i>
				<i id="scene_view-lab_content_salvage-icon" class="fa fa-lock" style="position:absolute;left:72%;top:38%;font-size:20px;"></i>
				<svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"  style="">
					<line x1="30" x2="40" y1="27.5" y2="27.5" stroke="rgb(200,200,214)"/>
					<line x1="30" x2="40" y1="52.5" y2="52.5" stroke="rgb(200,200,214)"/>
					<line x1="30" x2="40" y1="77.5" y2="77.5" stroke="rgb(200,200,214)"/>
					<line x1="30" x2="40" y1="27.5" y2="40" stroke="rgb(200,200,214)"/>
					<line x1="60" x2="70" y1="40" y2="40" stroke="rgb(200,200,214)"/>
    			</svg>
			</div>
		</div>
		<div id="scene_menu-settings" class="game hidden">
			<div id="scene_menu-settings_content" class="content background">
				<button id="scene_menu-settings_button-main" style="position:absolute;left:30%;top:15%;width:40%;height:10%">Advanced</button>
				<button id="scene_menu-settings_button-menu" style="position:absolute;left:30%;top:35%;width:40%;height:10%">Main&nbspMenu</button>
				<button id="scene_menu-settings_button-save" style="position:absolute;left:30%;top:55%;width:40%;height:10%">Download&nbspSave</button>
				<button id="scene_menu-settings_button-credits" style="position:absolute;left:30%;top:75%;width:40%;height:10%">Credits</button>
			</div>
		</div>
		<div id="scene_menu-settings_main" class="game hidden">
			<div id="scene_menu-settings_main_content" class="content background">
				<center>
				<label for="scene_menu-settings_main_content_key">Key Scroll Speed</label>
				<input type="range" id="scene_menu-settings_main_content_key" name="scene_menu-settings_main_content_key" min="1" max="10" step="1" value="2">
				</center>
			</div>
		</div>
		<div id="scene_menu-credits" class="game hidden" style="position:fixed;left:0%;top:7.5%;width:100%;height:92.5%">
			<div id="scene_menu-credits_content" class="background" style="position:fixed;left:10%;top:10%;width:80%;height:80%">
				<p id="scene_meu-credits_content_p" style="position:absolute;left:10%;top:10%;width:80%;height:80%;text-align:center;">All credit goes to Vortex418 (For Now)</p>
			</div>
		</div>
		<div id="nav" class="hidden" style="position:fixed;left:0%;top:0%;width:100%;height:7.5%;">
			<button id="nav_button-map" style="position:absolute;left:12.5%;top:5%;width:25%;height:90%;text-align:center;"><i class="fa fa-map" aria-hidden="true"></i> Map</button>
			<button id="nav_button-yard" style="position:absolute;left:37.5%;top:5%;width:25%;height:90%;text-align:center;"><i class="fa fa-wrench" aria-hidden="true"></i> Shipyard</button>
			<button id="nav_button-lab" style="position:absolute;left:62.5%;top:5%;width:25%;height:90%;text-align:center;"><i class="fa fa-flask" aria-hidden="true"></i> Labratory</button>
			<i id="nav_icon-settings" style="position:absolute;left:95%;top:5%;font-size:35px;text-align:center;" class="fa fa-cog" aria-hidden="true"></i>
		</div>
		<div id="crash" style="left:0;top:0;width:100%;height:100%;background-color:blue;font-family:courier;display:none;"></div>
	</body>
	<script id="script_processing" src="/annihilation/libraries/processing.js"></script>
	<script id="script_jquery" src="/annihilation/libraries/jquery.js"></script>
	<script>
//global functions
Object.prototype.toString = function(){return JSON.stringify(this)};
addEventListener("resize",function(){if(innerWidth != 1024 || innerHeight != 576){location.assign(location.href)}});
$("#script_processing").ready(function(){
	console.log("ANNIHILATION: "+game.version)
});
//variables
var mouseIsPressed = false;
var keyIsPressed = false;
var width = innerWidth;
var height = innerHeight;
var view = "none";
var cord = [0,0];
var borders = [1024,576];
var radius = [25,75];
var date = new Date();
var dev = {mode:false};
var win = {data: {},string: location.search.substring(1).split("&")};
var canvas = {clickable: true};
var user = {loaded: false,name: "",keys: {},meta: {},saves: {},savesLoaded: false};
var settings = {keySpeed: 2};
var i = 0;
var game = {
	version:location.href.split("/")[5].split(".html")[0],
	root:"/annihilation/",
	error: function(code,etc){
		throw "GameError: "+code+" \n	"+etc
	},
	crash: function(type,code,etc){
		console.error(type+" Game Crash: "+code+" \n	"+etc);
		$("body").attr("style","background-image:none;background-color:blue;font-family:courier");
		$("body").html("<p style='font-size:14px;text-align:left;position:fixed;left:0%;width:100%;top:0%;height:100%;'>If this crash was not intentional, please open a bug report and send a screenshot or the below info, then just reload the page.<br><br><br><br><br><br><br><br><br><br>Below is some data about your crash:<br><br>Crash Type: "+type+"<br>Error Code: "+code+"<br>Other Info: "+etc+"</p>")
	}	   
};
game.asset = game.root+"assets/"+game.version+"/";
$("title").html("Annihilation "+game.version);
var save = {//_SAVE
		selected: null,
		loaded: false,
		url: null,
        cookie: {
			name: [],
			date: [],
			type: [],
			data: JSON.parse(localStorage.getItem("save_data")),
			content: ["","","","","","","",""]
		},
		data: {
			info: {},
			planet: {},
			star: {},
			ship: {},
			tech: {}
		},
		info: {
			name: [],
			date: [],
			type: [],
			data: [],
			version: []
		},
		create: function(name,date,type,version,data){
			save.info.name.push(name);
			save.info.date.push(date);
			save.info.type.push(type);
			save.info.data.push(data);
			save.info.version.push(version)
			var container = $(document.createElement("div"));
			var pName = $(document.createElement("p"));
			var pDate = $(document.createElement("p"));
			var pType = $(document.createElement("p"));
			container.attr("id","scene_menu-load_save-"+name);
			container.css({"position":"absolute","width":"80%","height":"10%","left":"10%","top":((save.info.name.length-1)*16+12)+"%"});
			$("#scene_menu-load_content").append(container);
			container.addClass("background");container.addClass("clickable");
			pName.text(name);pDate.text(date);pType.text(type);
			$(pName).css({"font-size":"18px","position":"absolute","top":"-30%","left":"10%"});
			$(pDate).css({"font-size":"18px","position":"absolute","top":"-30%","left":"40%"});
			$(pType).css({"font-size":"18px","position":"absolute","top":"-30%","left":"70%"});
			container.append(pName);container.append(pDate);container.append(pType);
			container.on("click",function(){
				for(var i=0;i<save.info.name.length;i++){
					if(save.info.name[i] == name){
						save.selected = i;
						container.addClass("selected");
					} else {
						$("#scene_menu-load_save-"+save.info.name[i]).removeClass("selected")
					}	
				}
			});
		}
	};
	var tech = {
		points: 100,
		cost: [5,5,5,10,10,10,10,20],
		costInc: 1,
		price: [0],
		level: {
			base: 5,
			armor: 0,
			shield: 0,
			laser: 0,
			missle: 0,
			reload: 0,
			recharge: 0,
			construction: 0,
			salvage: 0,
			max: [50,50,50,50,25,50,50,25]
		}
	};
	var numeral = ["","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVII","XXVII","XXVIII","XXIX","XXX","XXXI","XXXII","XXXIII","XXXIV","XXXV","XXXVI","XXXVII","XXXVIII","XXXIX","XL","XLI","XLII","XLIII","XLIV","XLV","XLVI","XLVII","XLVIII","XLIX","L","LI","LII","LIII","LIV","LV","LVI","LVII","LVIII","LIX","LX","LXI","LXII","LXIII","LXIV","LXV","LXVI","LXVII","LXVIII","LXIX","LXX","LXXI","LXXII","LXXIII","LXXIV","LXXV","LXXVI","LXXVII","LXXVIII","LXXIX","LXXX","LXXXI","LXXXII","LXXXIII","LXXXIV","LXXXV","LXXXVI","LXXXVII","LXXXVIII","LXXXIX","XC","XCI","XCII","XCIII","XCIV","XCV","XCVI","XCVII","XCVIII","XCIX","C"];
	var resource = {
		metal: 10000,
		minerals: 5000,
		fuel: 2500,
		ancient_tech: 0,
		code_snippets: 0,
		multiplyer: 1,
		claimed: 0,
		max: 10
	};
	var star = {x:[],y:[],size:[],num:128};
	var planet = {
		name: ["crash site", "Abrigato", "Beta-Keralis", "Suzum", "Vespa", "Coruscare", "Vulca", "Jaeger", "Kashyyyk", "Outpost42","Victoria Alpha","Victoria Bravo", "Gesht", "Sanctuary", "Snowmass", "Ja", "Keeg", "Haemeiguli", "Borebalae", "Albataetarius", "Hataerius", "Achernaiphoros", "Antadrophei", "Hoemeirai", "Antabalis", "Hoereo", "Pazadam", "Equidor", "Pax", "Xena", "Titan", "Oturn", "Thuamia", "Heuthea", "Ditharus", "Muxater", "Trukovis", "Bichotune", "Etis", "Leorus", "Aphus", "Harophos", "Athena", "Hades", "Icarus", "Ureus", "Xentos Prime", "Delta Ketlak", "Aerox", "Thryox", "Stratus", "Nox", "Sanctum", "Pastūra", "Tinctus", "Morbus", "Neos", "Nomen", "Numerus", "Pax", "Fornax", "Skorda", "Alli", "Resurs","Home!"],
		status: [],x: [],y: [],r: [],color: {r: [],g: [],b: [],},
		difficulty: ["very easy","easy","easy-medium","medium","medium-hard","hard","very hard","extremly hard","hard-insane","insane"],
		num: 65
	};
	// everything ship related!
	var ship = {
		generic: {
			health: {corvette:10,frigate:25,crusier:50,destroyer:100,battleship:250,dreadnought:1000},
			shields: {corvette:20,frigate:40,crusier:75,destroyer:250,battleship:500,dreadnought:2000},
			damage: {corvette:1,frigate:5,crusier:10,destroyer:25,battleship:100,dreadnought:250},
			reload: {corvette:0.5,frigate:1,crusier:2,destroyer:1,battleship:1,dreadnought:1},
			width: {corvette:25,frigate:36,crusier:75,destroyer:100,battleship:150,dreadnought:160},
			height: {corvette:24,frigate:18,crusier:50,destroyer:50,battleship:60,dreadnought:131},
			x: [width/64*28,width/64*28,width/64*28,width/64*28,width/64*28,width/64*28,width/64*28,width/64*20,width/64*20,width/64*20,width/64*20,width/64*20,width/64*20,width/64*20,width/64*12,width/64*12,width/64*12,width/64*12,width/64*12,width/64*12,width/64*12,width/64*4,width/64*4,width/64*4,width/64*4],
			y: [width/64*16,width/64*12,width/64*20,width/64*8,width/64*24,width/64*4,width/64*28,width/64*2,width/64*36,width/64*56,width/64*41,width/64*51,width/64*48,width/64*10,width/64*31,width/64*31,width/64*8,width/64*40,width/64*4,width/64*10,width/64*59,width/64*52,width/64*29,width/64*10,width/64*27],
		},
		display: {
			level: ["","","","","",""]
		},
		cost: {
			metal: {corvette:1000,frigate:2000,crusier:4000,destroyer:10000,battleship:25000,dreadnought:100000},
			minerals: {corvette:500,frigate:2000,crusier:1000,destroyer:4000,battleship:10000,dreadnought:50000},
			fuel: {corvette:250,frigate:500,crusier:1000,destroyer:2500,battleship:5000,dreadnought:25000},
			ancient_tech: {
				corvette: [1,2,4,8,16,32],
				frigate: [2,4,7,9,12,15],
				crusier: [3,5,8,12,18,26],
				destroyer: [8,12,20,35,60,75],
				battleship: [10,25,45,70,100,135],
				dreadnought: [25,50,100,150,250,400]
			},
			code_snippets: {
				corvette: [1,2,5,10,20,35,50],
				frigate: [5,10,20,30,35,40],
				crusier: [10,20,30,40,50,60],
				destroyer: [25,40,60,85,100,125],
				battleship: [20,25,40,55,70,85],
				dreadnought: [50,75,88,100,125,150]
			}
		},
		fleet: {
			type: [],
			health: [],
			shields: [],
			damage: [],
			reload: [],
			level: {corvette:0,frigate:0,crusier:0,destroyer:0,battleship:0,dreadnought:0},
			crit: {
				chance: 30+tech.level.missle,
				damage: 50+tech.level.missle*5
			},
			multiplyer: {
				damage: 1+tech.level.laser*0.2,
				shields: 1+tech.level.shield*0.4,
				health: 1+tech.level.armor*0.15
			}
		},
		frozen: {
			health: [0],
			shields: [0],
			reload: [0]
		},
		battle: {
			active: false,
			won: null,
		},
		draw: function(){game.crash("Fatal (4)","FUNCTION_REWRITE_FAILURE","Failed to overwrite ship.draw()")},
		num: function(filter){
			var count = 0;
			for(var i=0;i < ship.fleet.type.length;i++){
				if(ship.fleet.type[i] == filter){count++;}
			}
			return count;
		},
		total: {
			health: 0,
			shields: 0,
			reload: 0
		},
		add: function(type){
			ship.fleet.type.push(type);
			ship.fleet.health.push(ship.generic.health[type]);
			ship.fleet.shields.push(ship.generic.shields[type]);
			ship.fleet.damage.push(ship.generic.damage[type]);
			ship.fleet.reload.push(ship.generic.reload[type]);
		}
	};
	var enemy = {
		generic: {
			x: [width/64*50,width/64*50,width/64*50,width/64*50,width/64*50,width/64*50,width/64*50,width/64*44,width/64*44,width/64*44,width/64*44,width/64*44,width/64*44,width/64*44,width/64*38,width/64*38,width/64*38,width/64*38,width/64*38,width/64*38,width/64*38],
			y: [height/64*32,height/64*24,height/64*40,height/64*16,height/64*48,height/64*8,height/64*56,height/64*32,height/64*24,height/64*40,height/64*16,height/64*48,height/64*8,height/64*56,height/64*32,height/64*24,height/64*40,height/64*16,height/64*48,height/64*8,height/64*56,height/64*32,height/64*24,height/64*40,height/64*16,height/64*48,height/64*8,height/64*56]
		},
		fleet: {
			type: [
				[null]
				["frigate","corvette","corvette"],
				["frigate","corvette","corvette","corvette","corvette"],
				["frigate","frigate","frigate","frigate","frigate"],
				["crusier","frigate","frigate","corvette","corvette"],
				["crusier","frigate","frigate","frigate","frigate"],
				["crusier","crusier","crusier","corvette","corvette"],
				["destroyer","crusier","crusier","corvette","corvette","corvette","corvette"],
				["destroyer","crusier","crusier","frigate","frigate"],
				["destroyer","crusier","crusier","crusier","crusier"],
				["destroyer","destroyer","destroyer","crusier","crusier"],
				["destroyer","destroyer","destroyer","destroyer","destroyer"],
				["battleship","destroyer","destroyer","destroyer","destroyer"],
				["battleship","battleship","battleship","destroyer","destroyer"],
				["battleship","battleship","battleship","destroyer","destroyer","destroyer","destroyer","destroyer"],
				["battleship","battleship","battleship","battleship","battleship","crusier","crusier","crusier"],
				["battleship","battleship","battleship","battleship","battleship","frigate","frigate","frigate","frigate","frigate"],
				["battleship","battleship","battleship","battleship","battleship","crusier","crusier","crusier","destroyer","destroyer"],
				["crusier","battleship","battleship","battleship","battleship","battleship","battleship","destroyer","destroyer","destroyer","corvette","corvette"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["battleship","battleship","battleship","battleship","battleship"],
				["dreadnought","dreadnought","dreadnought","dreadnought","dreadnought"],
["dreadnought","dreadnought","dreadnought","dreadnought","dreadnought","dreadnought","dreadnought","dreadnought","dreadnought"]
			],
			health: [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],
			shields: [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],
			damage: [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],
			reload: [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],
		},
			frozen: {
			health: [],
			shields: [],
			reload: []
		},
		total: {
			health: 0,
			shields: 0,
			damage: 0
		}
	};
	var $a = {//_$a
		version: game.version,
		root: game.root,
		view: view,
		width: innerWidth,
		height: innerHeight,
		cord: cord,
		borders: borders,
		radius: radius,
		date: date,
		canvas: canvas,
		user: user,
		dev: dev,
		user: user,
		save: window.save,
		planet: planet,
		enemy: enemy,
		ship: ship,
		star: star,
		tech: tech,
		resource: resource,
		numeral: numeral,
		settings: settings,
		win: win
	};
	var procKeys = {a: false,b: false,c: false,d: false,e: false,f: false,g: false,h: false,i: false,j: false,k: false,l: false,m: false,n: false,o: false,p: false,q: false,r: false,s: false,t: false,u: false,v: false,w: false,x: false,y: false,z: false};	
	var cookie = {};
	for(i = 0; i<document.cookie.split('; ').length; i++){
		cookie[document.cookie.split('; ')[i].split('=')[0]] = document.cookie.split('; ')[i].split('=')[1]
	}
	if(cookie["save_name"] != undefined){
		save.cookie.name = cookie["save_name"].split(",");
		save.cookie.date = cookie["save_date"].split(",");
		save.cookie.type = cookie["save_type"].split(",");
		save.cookie.version = cookie["save_version"].split(",");
	}
	function cls(){console.clear()};
	function dist(a1,a2,b1,b2){
		var a,b;
		if(a1 > a2){a = a1-a2}else{a=a2-a1}
		if(b1 > b2){b = b1-b2}else{b=b2-b1}
		return Math.sqrt(a**2 + b**2);
	};
	function minimize(n){
		if(n > 1e+63-1){return "Infinity"}
		else if(n > 1e+60-1){return Math.round(n/1e+60)+"ND"}
		else if(n > 1e+57-1){return Math.round(n/1e+57)+"OD"}
		else if(n > 1e+54-1){return Math.round(n/1e+54)+"SD"}
		else if(n > 1e+51-1){return Math.round(n/1e+51)+"sD"}
		else if(n > 1e+48-1){return Math.round(n/1e+48)+"QD"}
		else if(n > 1e+45-1){return Math.round(n/1e+45)+"qD"}
		else if(n > 1e+42-1){return Math.round(n/1e+42)+"TD"}
		else if(n > 1e+39-1){return Math.round(n/1e+39)+"DD"}
		else if(n > 1e+36-1){return Math.round(n/1e+36)+"UD"}
		else if(n > 1e+33-1){return Math.round(n/1e+33)+"D"}
		else if(n > 1e+30-1){return Math.round(n/1e+30)+"N"}
		else if(n > 1e+27-1){return Math.round(n/1e+27)+"O"}
		else if(n > 1e+24-1){return Math.round(n/1e+24)+"S"}
		else if(n > 1e+21-1){return Math.round(n/1e+21)+"s"}
		else if(n > 1e+18-1){return Math.round(n/1e+18)+"Q"}
		else if(n > 1e+15-1){return Math.round(n/1e+15)+"q"}
		else if(n > 1e+12-1){return Math.round(n/1e+12)+"T"}
		else if(n > 1e+09-1){return Math.round(n/1e+09)+"B"}
		else if(n > 1e+06-1){return Math.round(n/1e+06)+"M"}
		else if(n > 1e+03-1){return Math.round(n/1e+03)+"K"}
		else if(n < 1e-03-1){return Math.round(n/1e+03)+"K"}
		else if(n < 1e-06-1){return Math.round(n/1e+03)+"M"}
		else if(n < 1e-09-1){return Math.round(n/1e+03)+"B"}
		else if(n < 1e-12-1){return Math.round(n/1e+03)+"T"}
		else if(n < 1e-15-1){return Math.round(n/1e+03)+"q"}
		else {return n}
 	};
	function tooltip(sel,content,style = sel){
		if(!$(sel).attr("tooltip")){
			var div = $(document.createElement("div"));
			var p = $(document.createElement("p"));
			var c = content.split("<br>").length;
			var h = parseFloat(height);
			var s = {
				width: parseFloat($(style).css("width")),
				height: parseFloat($(style).css("height")),
				top: parseFloat($(style).css("top")),
				left: parseFloat($(style).css("left")),
				size: parseFloat($(style).css("font-size"))
			};
			if($(style).css("height").indexOf("%") >= 0){s.height = s.height}
			if($(style).css("top").indexOf("%") >= 0){s.top = s.top}
			div.html(p);
			p.html(content);
			if($(style).css("top").indexOf("%") >= 0 && s.top+s.height+s.sizePct > 100){$(div).css("top",s.top-(s.size*(c+c)*100/h))}
			else if(s.top+s.height+s.size*(c+1) > h){$(div).css("top",s.top-s.size*(c+1))}
			else if($(style).css("top").indexOf("%") >= 0){$(div).css("top",(s.top-(s.size*(c+c)*100/h))+"%");}
			else{$(div).css("top",s.top-s.size*(c+1))}
			$(div).css("height",s.size*(c+1));
			if($(style).css("width").indexOf("%") >= 0){$(div).css("width",s.width+"%")}else{$(div).css("width",s.width)}
			if($(style).css("left").indexOf("%") >= 0){$(div).css("left",s.left+"%")}else{$(div).css("left",s.left)}
			$(div).css("position","absolute");
			$(div).addClass("overlay");
			$(div).attr("id","tooltip_"+sel.slice(1));
			$(div).hide();
			$(sel).on("mouseover",function(){$(div).show()});$(sel).on("mouseout",function(){$(div).hide()});
			$(sel).attr("tooltip",true)
			$(sel).parent().append(div)
		} else {
			$("#tooltip_"+sel.slice(1)+">p").html(content)		
		}
	};
//Processing.js setup
function sketch(processingInstance){with(processingInstance){var save = window.save;
function getImage(url) {externals.sketch.imageCache.add(url);return loadImage(url)};
function sound(src) {$("#audio")[0].src=game.asset+"sound/"+src;$("#audio")[0].play()};
mousePressed = function(){mouseIsPressed = true};
mouseReleased = function(){mouseIsPressed = false};
keyPressed = function(){keyIsPressed = true};
keyReleased = function(){keyIsPressed = false};
	
	//Game Code
	size(innerWidth,innerHeight);
	ship.draw = function(type,x,y,direction){
		if(typeof direction != "string"){direction = "e"}
		image(getImage(game.asset+"ships/"+type+"-"+direction+".png"),x-20,y-20,ship.generic.width[type],ship.generic.height[type])
	};
	for(var i=0; i<win.string.length;i++){
		win.data[win.string[i].split("=")[0]] = decodeURIComponent(win.string[i].split("=")[1]);
		if(i == win.string.length-1 && win.data[""] !== "undefined"){
			console.groupCollapsed("Imported world data");
			for(i in win.data){
				console.log(Object.keys(win.data)[i] + ": " + win.data[i])
			}
			console.groupEnd();
		}
	}
	if(win.string != undefined && win.data.name != undefined && win.data.token != undefined){
		$.get("userData/"+win.data.name+"/token",function(token){
			if(winObj.token == token == cookie["token"]){
				user.name = win.data.name;
				user.active = true;
				console.log("logged in as "+user.name);
			}
		})
	}
	if(win.string != undefined && win.data.worldgen != undefined && win.data.worldgen != ""){
		var worldData = JSON.parse(win.data.worldgen);
		if(typeof worldData == "object"){
			if(typeof worldData.borders != undefined && worldData.borders != undefined){
				if(worldData.borders[0] > 0 && worldData.borders[1] > 0){
					borders[0] = parseFloat(worldData.borders[0]);
					borders[1] = parseFloat(worldData.borders[1]);
				}
				else if(worldData.borders[0] < 1 || worldData.borders[1] < worldData.borders[0]){borders = [innerWidth,innerHeight]}
			}
			else {console.warn("Could not load custom borders")}
			if(typeof worldData.radius != undefined && worldData.radius != undefined){
				if(worldData.radius[0] > 0 && worldData.radius[1] > worldData.radius[0]){
					radius[0] = parseFloat(worldData.radius[0]);
					radius[1] = parseFloat(worldData.radius[1]);
				}
				else if(worldData.radius[0] < 1){radius[0] = 25}
				else if(worldData.radius[1] < worldData.radius[0]+1){radius[1] = radius[0]+50}
			} 
			else {console.warn("Could not load custom radius")}
			if(typeof worldData.planets != undefined && worldData.planets != undefined){
				if(worldData.planets > 64){
					planet.num = parseFloat(worldData.planets);
				}
				else if(worldData.planets < 65){planet.num = 65}
			} 
			else{console.warn("Could not load custom planets")}
			if(typeof worldData.stars != undefined && worldData.stars != undefined){
				if(worldData.stars > 0){
					star.num = parseFloat(worldData.stars);
				}
				else if(worldData.stars < 1){star.num = 128}
			}
			else {console.warn("Could not load custom stars")}
		} else {
			game.crash("Fatal (3)","DATA_IMPORT_FAILURE","typeof worldgen must be object");
		}
	}
	for(var i = 0; i < star.num; i++){
		star.x[i] = round(random(0-borders[0],0+borders[0]));
		star.y[i] = round(random(0-borders[1],0+borders[1]));
		star.size[i] = round(random(radius[0]/20,radius[1]/20));
	}
	for(var i = 0; i < planet.num; i++){
		planet.x[i] = round(random(0-borders[0],0+borders[0]));
		planet.y[i] = round(random(0-borders[1],0+borders[1]));
		planet.r[i] = round(random(radius[0],radius[1]));
		if(i > 64){planet.name[i] = "["+i+"]"} 
		else {planet.name[i] = "["+i+"]"+planet.name[i]}
		if(i == planet.num){planet.color.r[i] = 200;planet.color.g[i] = 200;planet.color.b[i] = 214;planet.status[i] = -1}
		else if(i == 0){planet.color.r[i] = 128;planet.color.g[i] = 128;planet.color.b[i] = 128;planet.status[i] = 0}
		else{planet.color.r[i] = round(random(0,255));planet.color.g[i] = round(random(0,255));planet.color.b[i] = round(random(0,255));planet.status[i] = -1}
	}
	/*
	//FUTURE PLANET GEN CONCEPT//
	
	for(var i=0;i<planet.name.length;i++){
		var factor = [null,100((64-i)/64)^i,2,3,function(){
			if(i > 32){return ((i+32)^2)/64*1.5625}
		},5,6,7,(1+i)^i];
		var random = random(0,100);
		if(factor[1] > random){planet.sys.system[i] = 1}
		else if(factor[2] > random){planet.sys.system[i] = 2}
		else if(factor[3] > random){planet.sys.system[i] = 3}
		else if(factor[4] > random){planet.sys.system[i] = 4}
		else if(factor[5] > random){planet.sys.system[i] = 5}
		else if(factor[6] > random){planet.sys.system[i] = 6}
		else if(factor[7] > random){planet.sys.system[i] = 7}
		else if(factor[8] > random){planet.sys.system[i] = 8}
		else{alert("An error occured in planet generation.")}
		
	}*/
	var element = {
		show: function(id){
			for(var i = 0;i<id.length;i++){if($("#"+id[i]).hasClass("hidden") == true){$("#"+id[i]).removeClass("hidden")}}
		},
		hide: function(id){
			for(var i = 0;i<id.length;i++){if($("#"+id[i]).hasClass("hidden") == false){$("#"+id[i]).addClass("hidden")}}
		}	
	};
	function object(name,alligence,x,y,z,a,b,c){
		fill(255,255,255);
		if(alligence == 0){noStroke()}
		else if(alligence < 0){stroke(255,0,0)}
		else if(alligence > 0){stroke(0,255,0)}
        else if(typeof alligence == "object" && alligence != null && alligence.length == 3){stroke(alligence[0],alligence[1],alligence[2])}
        else {game.crash("Fatal (4)","RENDER_VALUE_INVALID","alligence ("+alligence+") not set or invalid for object \""+name+"\"")}
		text(name,x,y+(z*0.6));
		fill(a,b,c);
		ellipse(x,y,z,z);
	};
	for(var i=1;i < enemy.fleet.type.length;i++){
		for(var j=0;j<enemy.fleet.type[i].length;j++){
			enemy.fleet.health[i][j] = ship.generic.health[enemy.fleet.type[i][j]];
			enemy.fleet.shields[i][j] = ship.generic.shields[enemy.fleet.type[i][j]];
			enemy.fleet.damage[i][j] = ship.generic.damage[enemy.fleet.type[i][j]];
			enemy.fleet.reload[i][j] = ship.generic.reload[enemy.fleet.type[i][j]];
		}
	}
	$("#scene_menu-main_button-new").on("click",function(){
		element.hide(["scene_menu-main"]);
		element.show(["scene_menu-save"]);
	});
	$("#scene_menu-main_button-load").on("click",function(){
		element.hide(["scene_menu-main"]);
		element.show(["scene_menu-load"]);
	});
	$("#scene_menu-main_button-exit").on("click",function(){close()});
	$("#scene_menu-save_button").on("click",function(){
		save.create($("#scene_menu-save_input").val(),date.getFullYear()+"/"+parseFloat(date.getMonth())+1+"/"+date.getDate(),"offline",game.version,save.data);
		for(var i=0;i<save.info.name.length;i++){
			if(save.info.name[i] == $("#scene_menu-save_input").val()){
				save.selected = i;
				$("#scene_menu-load_save-"+save.info.name[i]).addClass("selected");
				console.log("Selected save \""+name+"\" at position "+save.selected);
			} else {
				$("#scene_menu-load_save-"+save.info.name[i]).removeClass("selected")
			}	
		}
		element.hide(["scene_menu-save"]);
		element.show(["scene_tips"]);
	});
	$("#scene_menu-load_button-back").on("click",function(){
		element.hide(["scene_menu-load"]);
		element.show(["scene_menu-main"]);
	});
	$("#scene_menu-load_button-new").on("click",function(){
		element.hide(["scene_menu-load"]);
		element.show(["scene_menu-save"]);
	});
	$("#scene_menu-load_button-download").on("click",function(){$("#download_link")[0].click});
	$("#scene_menu-load_button-delete").on("click",function(){
		for(var i=0;i<save.info.name.length;i++){
			if(i < save.selected){
				$("#scene_menu-load_save-"+save.info.name[i]).css("top",(i*16+12)+"%");
				console.log("Save at position "+i+" was not moved");
			}
			else if(i > save.selected){
				$("#scene_menu-load_save-"+save.info.name[i]).css("top",((i-1)*16+12)+"%");
				console.log("Save at position "+i+" was moved");
			}
			else if(i == save.selected){
				console.warn("Deleted save \""+save.info.name[i]+"\"");
				if(i == save.info.name.length-1){
					$("[id='scene_menu-load_save-"+save.info.name[i]+"']").remove();
					save.info.name.pop();document.cookie = "save_name="+save.info.name;
					save.info.date.pop();document.cookie = "save_date="+save.info.date;
					save.info.type.pop();document.cookie = "save_type="+save.info.type;
					save.info.data.pop();
					localStorage.setItem("save.info.data",JSON.stringify(save.info.data));
					save.info.version.pop();document.cookie = "save_version="+save.info.version;
					save.selected = null
				} else{
					$("[id='scene_menu-load_save-"+save.info.name[i]+"']").remove();
					save.info.name.splice(save.selected,1);document.cookie = "save_name="+save.info.name;
					save.info.date.splice(save.selected,1);document.cookie = "save_date="+save.info.date;
					save.info.type.splice(save.selected,1);document.cookie = "save_type="+save.info.type;
					save.info.data.splice(save.selected,1);
					localStorage.setItem("save.info.data",JSON.stringify(save.info.data));
					save.info.version.splice(save.selected,1);document.cookie = "save_version="+save.info.version;
					save.selected = null
				}
			}
			else {game.crash("Fatal (3)","SAVE_DEL_FAILURE","Unexpected failure in save deletion")}
		}
	});
	$("#scene_menu-load_button-upload").on("click",function(){
		save.loaded = false;
		$("#scene_menu-load_upload").trigger("click")
	});
	$("#scene_menu-load_button-play").on("click",function(){
		console.log("Attempting to load save \""+save.info.name[save.selected]+"\" at position "+save.selected);
		if(save.selected != null && save.info.data[save.selected] != undefined && save.info.data[save.selected] != null && save.info.data[save.selected] != ""){
			save.loadContent = save.info.data[save.selected];	 
			resource = save.loadContent.resource;
			planet = save.loadContent.planet;
			star = save.loadContent.star;
			ship.fleet = save.loadContent.ship;
			tech = save.loadContent.tech;
			settings = save.loadContent.settings;
			element.hide(["scene_menu-load"]);
			element.show(["nav","mycanvas"]);
			canvas.clickable=true;
			view = "map";
		} 
		else if(save.selected == null || save.selected == undefined){
				alert("You must select a save")
		}
		else {game.crash("Fatal (4)","JSON_PARSE_FAILURE","Failed to parse JSON in save \""+save.info.name[save.selected]+"\" \n	at position "+save.selected+"\"")}
	});
	$("#scene_menu-load_upload").on("change", function() {
		var reader = new FileReader();
		reader.onload = function(){
			if(save.loaded == false){
				save.uploaded = JSON.parse(reader.result);
				save.create(save.uploaded.info.name,save.uploaded.info.date,save.uploaded.info.type,save.uploaded);
				console.log("Loaded save \""+save.uploaded.info.name+"\" from "+save.uploaded.info.date);
				save.loaded = true;
			}
		};
		reader.readAsText(this.files[0]);	
	});	
	$("#scene_tips_button").on("click",function(){
		element.hide(["scene_tips"]);element.show(["nav","mycanvas"]);view="map";canvas.clickable=true;
	});
	$("#nav_button-map").on("click",function(){ship.battle.won=null;view="map";canvas.clickable=true;element.hide(["scene_menu-settings","scene_view-yard","scene_view-lab","scene_menu-credits","scene_view-report","scene_menu-settings_main"]);element.show(["mycanvas"])});
	$("#nav_button-yard").on("click",function(){ship.battle.won=null;view="none";canvas.clickable=false;element.hide(["scene_menu-settings","scene_view-map","scene_view-lab","scene_menu-credits","mycanvas","scene_view-report","scene_menu-settings_main"]);element.show(["scene_view-yard"]);});
	$("#nav_button-lab").on("click",function(){ship.battle.won=null;view="none";canvas.clickable=false;element.hide(["scene_menu-settings","scene_view-yard","scene_view-map","scene_menu-credits","mycanvas","scene_view-report","scene_menu-settings_main"]);element.show(["scene_view-lab"]);});
	$("#nav_icon-settings").on("click",function(){ship.battle.won=null;view=
		"none";canvas.clickable=false;element.hide(["scene_view-map","scene_view-yard","scene_view-lab","scene_menu-credits","mycanvas","scene_view-report","scene_menu-settings_main"]);element.show(["scene_menu-settings"])});
	$("#scene_menu-settings_button-menu").on("click",function(){element.hide(["scene_menu-settings","nav"]);element.show(["scene_menu-main"]);});
	$("#scene_menu-settings_button-credits").on("click",function(){element.hide(["scene_menu-settings"]);element.show(["scene_menu-credits"]);});
	$("#scene_menu-settings_button-main").on("click",function(){element.hide(["scene_menu-settings"]);element.show(["scene_menu-settings_main"]);});
	$("#scene_menu-settings_button-save").on("click",function(){$("#download_link")[0].click()});
	$("#scene_view-yard_content_corvette_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.corvette*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.corvette*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.corvette*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.corvette*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.corvette*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.corvette*(1-tech.level.construction/100);
			ship.add("corvette");   
		} else {console.log(ship.cost.metal)}
	});
	$("#scene_view-yard_content_frigate_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.frigate*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.frigate*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.frigate*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.frigate*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.frigate*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.frigate*(1-tech.level.construction/100);
			ship.add("frigate");   
		}
	});
	$("#scene_view-yard_content_crusier_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.crusier*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.crusier*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.crusier*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.crusier*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.crusier*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.crusier*(1-tech.level.construction/100);
			ship.add("crusier");   
		}
	});
	$("#scene_view-yard_content_destroyer_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.destroyer*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.destroyer*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.destroyer*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.destroyer*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.destroyer*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.destroyer*(1-tech.level.construction/100);
			ship.add("destroyer");   
		}
	});
	$("#scene_view-yard_content_battleship_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.battleship*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.battleship*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.battleship*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.battleship*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.battleship*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.battleship*(1-tech.level.construction/100);
			ship.add("battleship");   
		}
	});
	$("#scene_view-yard_content_dreadnought_button-new").on("click",function(){
		if(resource.metal >= ship.cost.metal.dreadnought*(1-tech.level.construction/100) && resource.minerals >= ship.cost.minerals.dreadnought*(1-tech.level.construction/100) && resource.fuel >= ship.cost.fuel.dreadnought*(1-tech.level.construction/100)){
			resource.metal -= ship.cost.metal.dreadnought*(1-tech.level.construction/100);
			resource.minerals -= ship.cost.minerals.dreadnought*(1-tech.level.construction/100);
			resource.fuel -= ship.cost.fuel.dreadnought*(1-tech.level.construction/100);
			ship.add("dreadnought");   
		} 
	});
	$("#scene_view-yard_content_corvette_button-up").on("click",function(){
		if(ship.fleet.level[0] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.corvette[ship.fleet.level[0]] && resource.code_snippets >= ship.cost.code_snippets.corvette[ship.fleet.level[0]]){
			resource.ancient_tech -= ship.cost.ancient_tech.corvette[ship.fleet.level[0]];
			resource.code_snippets -= ship.cost.code_snippets.corvette[ship.fleet.level[0]];
			ship.fleet.level[0]++;
			ship.display.level[0] += "*";
		}
	});
	$("#scene_view-yard_content_frigate_button-up").on("click",function(){
		if(ship.fleet.level[1] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.frigate[ship.fleet.level[1]] && resource.code_snippets >= ship.cost.code_snippets.frigate[ship.fleet.level[1]]){
			resource.ancient_tech -= ship.cost.ancient_tech.frigate[ship.fleet.level[1]];
			resource.code_snippets -= ship.cost.code_snippets.frigate[ship.fleet.level[1]];
			ship.fleet.level[1]++;
			ship.display.level[1] += "*";
		}
	});
	$("#scene_view-yard_content_crusier_button-up").on("click",function(){
		if(ship.fleet.level[2] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.crusier[ship.fleet.level[2]] && resource.code_snippets >= ship.cost.code_snippets.crusier[ship.fleet.level[2]]){
			resource.ancient_tech -= ship.cost.ancient_tech.crusier[ship.fleet.level[2]];
			resource.code_snippets -= ship.cost.code_snippets.crusier[ship.fleet.level[2]];
			ship.fleet.level[2]++;
			ship.display.level[2] += "*";
		}
	});
	$("#scene_view-yard_content_destroyer_button-up").on("click",function(){
		if(ship.fleet.level[3] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.destroyer[ship.fleet.level[3]] && resource.code_snippets >= ship.cost.code_snippets.destroyer[ship.fleet.level[3]]){
			resource.ancient_tech -= ship.cost.ancient_tech.destroyer[ship.fleet.level[3]];
			resource.code_snippets -= ship.cost.code_snippets.destroyer[ship.fleet.level[3]];
			ship.fleet.level[3]++;
			ship.display.level[3] += "*";
		}
	});
	$("#scene_view-yard_content_battleship_button-up").on("click",function(){
		if(ship.fleet.level[4] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.battleship[ship.fleet.level[4]] && resource.code_snippets >= ship.cost.code_snippets.battleship[ship.fleet.level[4]]){
			resource.ancient_tech -= ship.cost.ancient_tech.battleship[ship.fleet.level[4]];
			resource.code_snippets -= ship.cost.code_snippets.battleship[ship.fleet.level[4]];
			ship.fleet.level[4]++;
			ship.display.level[4] += "*";
		}
	});
	$("#scene_view-yard_content_dreadnought_button-up").on("click",function(){
		if(ship.fleet.level[5] < 5 && resource.ancient_tech >= ship.cost.ancient_tech.dreadnought[ship.fleet.level[5]] && resource.code_snippets >= ship.cost.code_snippets.dreadnought[ship.fleet.level[5]]){
			resource.ancient_tech -= ship.cost.ancient_tech.dreadnought[ship.fleet.level[5]];
			resource.code_snippets -= ship.cost.code_snippets.dreadnought[ship.fleet.level[5]];
			ship.fleet.level[5]++;
			ship.display.level[5] += "*";
		}
	});										 
	tooltip("#scene_view-yard_content_corvette_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.corvette[ship.fleet.level[0]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.corvette[ship.fleet.level[0]],"#scene_view-yard_content_corvette_button-new");
	tooltip("#scene_view-yard_content_frigate_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.frigate[ship.fleet.level[1]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.frigate[ship.fleet.level[1]],"#scene_view-yard_content_frigate_button-new");
	tooltip("#scene_view-yard_content_crusier_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.crusier[ship.fleet.level[2]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.crusier[ship.fleet.level[2]],"#scene_view-yard_content_crusier_button-new");
	tooltip("#scene_view-yard_content_destroyer_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.destroyer[ship.fleet.level[3]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.destroyer[ship.fleet.level[3]],"#scene_view-yard_content_destroyer_button-new");
	tooltip("#scene_view-yard_content_battleship_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.battleship[ship.fleet.level[4]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.battleship[ship.fleet.level[4]],"#scene_view-yard_content_battleship_button-new");
	tooltip("#scene_view-yard_content_dreadnought_button-up","Ancient Tech: "+resource.ancient_tech+"/"+ship.cost.ancient_tech.dreadnought[ship.fleet.level[5]]+"<br>"+"Code Snippets: "+resource.code_snippets+"/"+ship.cost.code_snippets.dreadnought[ship.fleet.level[5]],"#scene_view-yard_content_dreadnought_button-new");
	$("#scene_view-lab_content_armor-button").on("click",function(){
		if(tech.points >= tech.cost[0]+tech.level.armor*tech.costInc && tech.level.armor < tech.level.max[0]){
			tech.points -= tech.cost[0]+tech.level.armor*tech.costInc;
			tech.level.armor++;
		}
	});
	$("#scene_view-lab_content_laser-button").on("click",function(){
		if(tech.points >= tech.cost[1]+tech.level.laser*tech.costInc && tech.level.laser < tech.level.max[1]){
			tech.points -= tech.cost[1]+tech.level.laser*tech.costInc;
			tech.level.laser++;
		}
	});
	$("#scene_view-lab_content_reload-button").on("click",function(){
		if(tech.points >= tech.cost[2]+tech.level.reload*tech.costInc && tech.level.reload < tech.level.max[2]){
			tech.points -= tech.cost[2]+tech.level.reload*tech.costInc;
			tech.level.reload++;
		}
	});
	$("#scene_view-lab_content_construction-button").on("click",function(){
		if(tech.points >= tech.cost[3]+tech.level.construction*tech.costInc && tech.level.construction < tech.level.max[3] && tech.level.armor > 9){
			tech.points -= tech.cost[3]+tech.level.construction*tech.costInc;
			tech.level.construction++;
		}
	});
	$("#scene_view-lab_content_shields-button").on("click",function(){
		if(tech.points >= tech.cost[4]+tech.level.shield*tech.costInc && tech.level.shield < tech.level.max[4] && tech.level.armor > 4){
			tech.points -= tech.cost[4]+tech.level.shield*tech.costInc;
			tech.level.shield++;
		}
	});
	$("#scene_view-lab_content_missle-button").on("click",function(){
		if(tech.points >= tech.cost[5]+tech.level.missle*tech.costInc && tech.level.missle < tech.level.max[5] && tech.level.laser > 4){
			tech.points -= tech.cost[5]+tech.level.missle*tech.costInc;
			tech.level.missle++;
		}
	});
	$("#scene_view-lab_content_recharge-button").on("click",function(){
		if(tech.points > tech.cost[6]+tech.level.recharge*tech.costInc && tech.level.recharge < tech.level.max[6] && tech.level.reload > 4){
			tech.points -= tech.cost[6]+tech.level.recharge*tech.costInc;
			tech.level.recharge++;
		}
	});
	$("#scene_view-lab_content_salvage-button").on("click",function(){
		if(tech.points > tech.cost[7]+tech.level.salvage*tech.costInc && tech.level.salvage < tech.level.max[7] && tech.level.construction > 4){
			tech.points -= tech.cost[7]+tech.level.salvage*tech.costInc;
			tech.level.salvage++;
		}
	});
	$("#scene_view-yard_content_tax-button").on("click",function(){
		if(resource.claimed < 10){
			resource.claimed++;
			for(var i=0;i<planet.name.length;i++){
				if(planet.status[i] > 0){
					resource.metal += i*1000*resource.multiplyer;
					resource.minerals += i*500*resource.multiplyer;
					resource.fuel += i*400*resource.multiplyer;
					tech.points += i*resource.multiplyer;
				}
			}
		}
	});
	$("#scene_view-lab_content_tax-button").on("click",function(){
		if(resource.claimed < 10){
			resource.claimed++;
			for(var i=0;i<planet.name.length;i++){
				if(planet.status[i] > 0){
					resource.metal += i*1000*resource.multiplyer;
					resource.minerals += i*500*resource.multiplyer;
					resource.fuel += i*400*resource.multiplyer;
					tech.points += i*resource.multiplyer;
				}
			}
		}
	});
	$("#scene_view-map_i").on("click",function(){canvas.clickable=true;element.hide(["scene_view-map"])});
	$("#scene_view-map_button").on("click",function(){view = "battle";canvas.clickable = true;element.hide(["scene_view-map","nav"]);element.show(["scene_view-battle"])});
	$("#scene_view-report_i").on("click",function(){ship.battle.won=null;canvas.clickable=true;element.hide(["scene_view-report"])});
	$("#scene_view-report_button").on("click",function(){ship.battle.won=null;canvas.clickable=true;element.hide(["scene_view-report"])});
	$("#scene_view-battle_button").on("click",function(){
		ship.battle.active = false;
		ship.battle.won=false;
		element.hide(["scene_view-battle"]);
		element.show(["scene_view-report","nav"]);
		canvas.clickable=false;
		view = "map"
	});
	$("#overlay_dev_map_button").on("click",function(){
		mouseIsPressed=false;
		planet.selected=$("#overlay_dev_map_input").val();
		document.body.style.cursor = "default";
		var px,py;
		if(planet.selected < planet.num){
			if(planet.y[planet.selected] < 1){
				cord = [planet.x[planet.selected],0-planet.y[planet.selected]];
				console.log("Warped view to ["+cord+"]");
			} else {
				cord = [planet.x[planet.selected],planet.y[planet.selected]];
				console.log("Warped view to ["+cord+"]");
			}
		} else {game.crash("Fatal (4)","PLANET_VALUE_INVALID","Value of planet.selected must be less than planet.num")}
		canvas.clickable=false;
		element.show(["scene_view-map"])
	});
	if(user.active == true && user.name != null && user.name == undefined){
		for(var i=0;i<user.saves.length;i++){
			save.create(user.saves[i].name,user.saves[i].date,"online",user.saves[i].version,user.saves[i]);
		}
	}
	if(cookie["save_name"] == null || cookie["save_name"] == ""){console.warn("No local saves found")}
	for(var i=0;i<save.cookie.name.length;i++){
		if(save.cookie.name[i] != null && save.cookie.name[i] != undefined && save.cookie.name[i] != ""){
			save.create(save.cookie.name[i], save.cookie.date[i], save.cookie.type[i], save.cookie.version[i], save.cookie.data[i]);
			if(i == 0){console.groupCollapsed("Imported Saves")}
			console.log("Imported local save \""+save.cookie.name[i]+"\"");
			if(i == save.cookie.name.length-1){console.groupEnd()}
			
		}
	}
    document.body.addEventListener("click",function(){
		save.url = URL.createObjectURL(new Blob([JSON.stringify(save.data)], {type: "text/json"}));
		$("#download_link").attr("href",save.url);
		if(typeof save.selected == "number"){
			if(save.info.name[save.selected] != ""){
				$("#download_link").attr("download",save.info.name[save.selected]+".json")
			}
			else {$("#download_link").attr("download","save.json")}
        	if(save.info.type[save.selected] == "offline"){
        	    document.cookie = "save_name="+save.info.name;
        	    document.cookie = "save_date="+save.info.date;
        	    document.cookie = "save_type="+save.info.type;
				document.cookie = "save_version="+save.info.version;
        	    localStorage.setItem("save_data",JSON.stringify(save.info.data));
        	}
			else if(save.info.type[save.selected] == "online"){
				console.warn("Your "+save.info.type[save.selected]+" save \""+save.info.name[save.selected]+"\" could not be saved autmatically!");
			} 
        	else{game.crash("Fatal (3)","AUTOSAVE_FAILURE","Autosave failed with save \""+save.info.name[save.selected]+"\" \n	at position "+save.selected)} 
		}
    });
	if(win.string != undefined && win.data.save != undefined && win.data.save != null && win.data.save != ""){
		if(win.data.view == "map" || win.data.view == "yard" || win.data.view == "lab" || win.data.view == "settings"){
			for(var i = 0;i < save.info.name.length; i++){
				if(save.info.name[i] == winObj.save){	 
					resource = save.info.data[i].resource;
					planet = save.info.data[i].planet;
					star = save.info.data[i].star;
					ship.fleet = save.info.data[i].ship;
					tech = save.info.data[i].tech;
					settings = save.info.data[i].settings;
					save.selected = i;
					if(winObj.view == "map"){
						view="map";element.hide(["scene_menu-main"]);element.show(["nav","mycanvas"])
					}
					else if(winObj.view == "yard"){
						element.hide(["scene_menu-main"]);element.show(["nav","scene_view-yard"])
					}
					else if(winObj.view == "lab"){
						element.hide(["scene_menu-main"]);element.show(["nav","scene_view-lab"])
					}
					else if(winObj.view == "settings"){
						element.hide(["scene_menu-main"]);element.show(["nav","scene_menu-settings"])
					}
					else{game.crash("Fatal (4)","DATA_IMPORT_FAILURE","Invalid value for view")}
				}
				else if(i == save.info.name.length-1){
					console.error("Couldn't find save \""+winObj.save+"\"");
					alert("Couldn't find save \""+winObj.save+"\"");
				}
			}
		}else{game.crash("Not-Fatal (2)","DATA_IMPORT_FAILURE","Invalid value for view")}
	}
	document.addEventListener("keydown",function(e){
    	if (e.key == "D") {  // case sensitive
			if(dev.mode == false && (view == "map" || view == "battle")){dev.mode = true}else{dev.mode = false}
    	} 
		else if (e.key == "C"){game.crash("Non-Fatal (2)","MANUAL_CRASH","Manual crash initiated")}
	});
	
	
	
	draw = function(){//_DRAW
		background(0,0,0);
		save.data.info.name = save.info.name[save.selected];
		save.data.info.date = save.info.date[save.selected];
		save.data.info.type = save.info.type[save.selected];
		save.data.resource = resource;
		save.data.planet = planet; 
		save.data.star = star;
		save.data.ship = ship.fleet;
		save.data.tech = tech;
		save.data.settings = settings;
		save.content = JSON.stringify(save.data);
		$("#data-meta").val(cord+" | "+borders+" | "+view+" | "+settings+" | "+user);
		$("#data-ship").val(ship);
		$("#data-ship-fleet").val(ship.fleet);
		$("#data-ship-cost").val(ship.cost);
		$("#data-ship-generic").val(ship.generic);
		$("#data-enemy").val(enemy);
		$("#data-tech").val(tech);
		$("#data-planets").val(planet);
		$("#data-stars").val(star);
		$("#data-save").val(save);
		$("#data-resource").val(resource);
		if(planet.selected > 64){
			game.crash("Fatal (4)","PLANET_VAR_FAILURE","Enemy fleet data is undefined");
		}
		ship.total.damage = 0;
		ship.total.health = 0;
		ship.total.shields = 0;
		enemy.total.damage = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
		enemy.total.health = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
		enemy.total.shields = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
		for(var i = 0; i<ship.fleet.type.length; i++){
			if(i == 0){
				ship.total.damage = 0;
				ship.total.health = 0;
				ship.total.shields = 0;
			}
			ship.total.damage += ship.fleet.damage[i];
			ship.total.health += ship.fleet.health[i];
			ship.total.shields += ship.fleet.shields[i];
		}
		for(var i = 1; i < enemy.fleet.type.length;i++){
			for(var j=0;j<enemy.fleet.type[i].length; j++){
				if(i == 0){
					enemy.total.damage[i] = 0;
					enemy.total.health[i] = 0;
					enemy.total.shields[i] = 0;   
				}
				enemy.total.damage[i] += enemy.fleet.damage[i][j];
				enemy.total.health[i] += enemy.fleet.health[i][j];
				enemy.total.shields[i] += enemy.fleet.shields[i][j];
			}
		}
		if(ship.battle.active == false){
			for(var i = 1;i < enemy.fleet.type.length;i++){
				ship.frozen.health = ship.total.health;
				ship.frozen.shields = ship.total.shields;
				enemy.frozen.health[i] = enemy.total.health[i];
				enemy.frozen.shields[i] = enemy.total.shields[i];
			}
			for(var i = 0;i<ship.fleet.type.length;i++){
				ship.fleet.shields[i] = ship.generic.shields[ship.fleet.type[i]];
			}
		}
		tech.points = parseFloat(tech.points);
		resource.metal = parseFloat(resource.metal);
		resource.minerals = parseFloat(resource.minerals);
		resource.fuel = parseFloat(resource.fuel);
		resource.ancient_tech = parseFloat(resource.ancient_tech);
		resource.code_snippets = parseFloat(resource.code_snippets);
		borders[0] = Number(borders[0]);
		borders[1] = Number(borders[1]);
		radius[0] = Number(radius[0]);
		radius[1] = Number(radius[1]);
		for(var i=0;i<planet.name.length-1;i++){
			planet.color.r[i] = parseFloat(planet.color.r[i]);
			planet.color.g[i] = parseFloat(planet.color.g[i]);
			planet.color.b[i] = parseFloat(planet.color.b[i]);
		}
		tech.price = [Number(tech.level.armor)+5,Number(tech.level.shield)+10,Number(tech.level.laser)+5,parseFloat(tech.level.missle)+10,Number(tech.level.reload)+5,parseFloat(tech.level.recharge)+10];
		if(settings.keySpeed < 11){settings.keySpeed = Number($("#scene_menu-settings_main_content_key").val())}
		$("#scene_view-yard_content_resources_metal").html("Metal: "+minimize(resource.metal));
		$("#scene_view-yard_content_resources_minerals").html("Minerals: "+minimize(resource.minerals));
		$("#scene_view-yard_content_resources_fuel").html("Fuel: "+minimize(resource.fuel));
		$("#scene_view-yard_content_corvette_button-new").html("Corvette"+ship.display.level[0]+" ["+ship.num("corvette")+"]");
		$("#scene_view-yard_content_frigate_button-new").html("Frigate"+ship.display.level[1]+" ["+ship.num("frigate")+"]");
		$("#scene_view-yard_content_crusier_button-new").html("Crusier"+ship.display.level[2]+" ["+ship.num("crusier")+"]");
		$("#scene_view-yard_content_destroyer_button-new").html("Destroyer"+ship.display.level[3]+" ["+ship.num("destroyer")+"]");
		$("#scene_view-yard_content_battleship_button-new").html("Battleship"+ship.display.level[4]+" ["+ship.num("battleship")+"]");
		$("#scene_view-yard_content_dreadnought_button-new").html("Dreadnought"+ship.display.level[5]+" ["+ship.num("dreadnought")+"]");
		tooltip("#scene_view-yard_content_corvette_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.corvette)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.corvette)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.corvette)+"<br>","#scene_view-yard_content_corvette_button-new");
		tooltip("#scene_view-yard_content_frigate_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.friagte)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.frigate)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.frigate)+"<br>","#scene_view-yard_content_frigate_button-new");
		tooltip("#scene_view-yard_content_crusier_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.crusier)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.crusier)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.cruiser)+"<br>","#scene_view-yard_content_crusier_button-new");
		tooltip("#scene_view-yard_content_destroyer_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.destroyer)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.destroyer)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.destroyer)+"<br>","#scene_view-yard_content_destroyer_button-new");
		tooltip("#scene_view-yard_content_battleship_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.battleship)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.battleship)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.battleship)+"<br>","#scene_view-yard_content_battleship_button-new");
		tooltip("#scene_view-yard_content_dreadnought_button-i","<strong>Material Cost</strong><br>Metal: "+minimize(resource.metal)+"/"+minimize(ship.cost.metal.dreadnought)+"<br>Minerals: "+minimize(resource.minerals)+"/"+minimize(ship.cost.minerals.dreadnought)+"<br>Fuel: "+minimize(resource.fuel)+"/"+minimize(ship.cost.fuel.dreadnought)+"<br>","#scene_view-yard_content_dreadnought_button-new");
		tooltip("#scene_view-yard_content_tax-button","Collected: "+resource.claimed+"/"+resource.max);
		tooltip("#scene_view-lab_content_tax-button","Collected: "+resource.claimed+"/"+resource.max);
		$("#scene_view-lab_content_points").html("Research Points: "+minimize(tech.points));
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_armor-button").html("Armor "+numeral[tech.level.armor])
		} 
		else {$("#scene_view-lab_content_armor-button").html("Armor "+minimize(tech.level.armor))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_laser-button").html("Laser "+numeral[tech.level.laser])
		}
		else{$("#scene_view-lab_content_laser-button").html("Laser "+minimize(tech.level.laser))}
		if(tech.level.laser < numeral.length && tech.level.laser > -1){
			$("#scene_view-lab_content_reload-button").html("Reload "+numeral[tech.level.reload])
		}
		else{$("#scene_view-lab_content_reload-button").html("Reload "+minimize(tech.level.reload))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_construction-button").html("Construction "+numeral[tech.level.construction])
		}
		else{$("#scene_view-lab_content_construction-button").html("Construction "+minimize(tech.level.construction))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_shields-button").html("Shields "+numeral[tech.level.shield])
		}
		else{$("#scene_view-lab_content_shields-button").html("Shields "+minimize(tech.level.shield))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_missle-button").html("Missles "+numeral[tech.level.missle])
		}
		else{$("#scene_view-lab_content_missle-button").html("Missles "+minimize(tech.level.missle))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_recharge-button").html("Recharge "+numeral[tech.level.recharge])
		}
		else{$("#scene_view-lab_content_recharge-button").html("Recharge "+minimize(tech.level.recharge))}
		if(tech.level.armor < numeral.length && tech.level.armor > -1){
			$("#scene_view-lab_content_salvage-button").html("Salvage "+numeral[tech.level.salvage])
		}
		else{$("#scene_view-lab_content_salvage-button").html("Salvage "+minimize(tech.level.salvage))}
		tooltip("#scene_view-lab_content_armor-button","Increases armor<br>Cost: "+(tech.cost[0]+tech.level.armor*tech.costInc));
		tooltip("#scene_view-lab_content_laser-button","Increases base<br>damage<br>Cost: "+(tech.cost[1]+tech.level.laser*tech.costInc));
		tooltip("#scene_view-lab_content_reload-button","Decreases shot<br>cooldown<br>Cost: "+(tech.cost[2]+tech.level.reload*tech.costInc));
		tooltip("#scene_view-lab_content_construction-button","Decreases ship<br>material cost<br>Cost: "+(tech.cost[3]+tech.level.construction*tech.costInc));
		tooltip("#scene_view-lab_content_shields-button","Increases shields<br>Cost: "+(tech.cost[4]+tech.level.shield*tech.costInc));
		tooltip("#scene_view-lab_content_missle-button","Increases critical<br>chance and<br>damage<br>Cost: "+(tech.cost[5]+tech.level.missle*tech.costInc));
		tooltip("#scene_view-lab_content_recharge-button","Increases energy<br>regain<br>Cost: "+(tech.cost[6]+tech.level.recharge*tech.costInc));
		tooltip("#scene_view-lab_content_salvage-button","Increases chance<br>for rares item drops<br>Cost: "+(tech.cost[7]+tech.level.salvage*tech.costInc));
		var statusText;
		if(planet.status[planet.selected] > -1){$("#scene_view-map_button").disabled = true;statusText="Captured!"}
		else if(planet.status[planet.selected] < 0){$("#scene_view-map_button").disabled = false;statusText="Occupied!"}
		$("#scene_view-map_p").html("Planet:&nbsp"+planet.name[planet.selected]+"&nbsp&nbsp&nbspStatus:&nbsp"+statusText+"<br><br>");
		var rareText;
		if(ship.battle.won==true){statusText="You Won!"}else{statusText="You Lost!"}
		if(resource.random < 5+tech.level.salvage){rareText="You got "+planet.selected+" ancient tech!"}
		else if(resource.random > 95-tech.level.salvage){rareText="You got "+planet.selected+" code snippets!"}
		else {rareText="You didn't get any rare items!"}
		$("#scene_view-report_p").html("Planet:&nbsp"+planet.name[planet.selected]+"<br><br>"+statusText+"<br><br>"+rareText);
		if(tech.level.armor > 4){$("#scene_view-lab_content_shields-icon").removeClass("fa-lock")}else{$("#scene_view-lab_content_shields-icon").addClass("fa-lock")}
		if(tech.level.armor >  9){$("#scene_view-lab_content_construction-icon").removeClass("fa-lock")}else{$("#scene_view-lab_content_construction-icon").addClass("fa-lock")}
		if(tech.level.laser > 4){$("#scene_view-lab_content_missle-icon").removeClass("fa-lock")}else{$("#scene_view-lab_content_missle-icon").addClass("fa-lock")}
		if(tech.level.reload > 4){$("#scene_view-lab_content_recharge-icon").removeClass("fa-lock")}else{$("#scene_view-lab_content_recharge-icon").addClass("fa-lock")}
		if(tech.level.construction > 4){$("#scene_view-lab_content_salvage-icon").removeClass("fa-lock")}else{$("#scene_view-lab_content_salvage-icon").addClass("fa-lock")}
	//Battle/Map ---> This is the processing.js that is remaining
		if(view == "map"){
			background(0,0,0);
			fill(255,255,255);
			noStroke();
			for(var i = 0; i < star.size.length; i++){
				ellipse(innerWidth/2+(star.x[i]-cord[0]), innerHeight/2+(star.y[i]+cord[1]),star.size[i],star.size[i]);
			}
			for(var i=0;i<planet.name.length;i++){
				object(planet.name[i], planet.status[i], innerWidth/2+(planet.x[i]-cord[0]), innerHeight/2+(planet.y[i]+cord[1]), planet.r[i], planet.color.r[i], planet.color.g[i], planet.color.b[i]);
				//if(dist(innerWidth/2+(planet.x[i]-cord[0]),mouseX,innerHeight/2+(planet.y[i]+cord[1]),mouseY) > planet.r[i]){
				//	document.body.style.cursor = "default";
				//
				if(dist(innerWidth/2+(planet.x[i]-cord[0]),mouseX,innerHeight/2+(planet.y[i]+cord[1]),mouseY-(innerHeight*0.075)) <= planet.r[i]*0.75){
					document.body.style.cursor = "pointer";
					planet.selected=i;
					if(dev.mode == true){
						document.body.style.cursor = "pointer";
						fill(255,255,255);
						textSize(innerWidth*0.016);
						text(planet.name[i],innerWidth*0.01,innerHeight*0.80);
						text("["+planet.x[i]+", "+planet.y[i]+"]",innerWidth*0.01,innerHeight*0.85);
						text(dist(innerWidth/2+(planet.x[i]-cord[0]),mouseX,innerHeight/2+(planet.y[i]+cord[1]),mouseY-(innerHeight*0.075)),innerWidth*0.01,innerHeight*0.90);
						object("", [255,255,255], innerWidth/2+(planet.x[i]-cord[0]), innerHeight/2+(planet.y[i]+cord[1]), planet.r[i], planet.color.r[i], planet.color.g[i], planet.color.b[i]);
					}
					if(mouseIsPressed && canvas.clickable == true){mouseIsPressed=false;canvas.clickable = false; document.body.style.cursor = "default";element.show(["scene_view-map"])}
				} else {document.body.style.cursor = "default"}
				//if(dist(innerWidth/2+(planet.x[i]-cord[0]),mouseX,innerHeight/2+(planet.y[i]+cord[1]),mouseY) > planet.r[i]){
				//	document.body.style.cursor = "default";
				//}
			}
			if(dev.mode == true){
				stroke(255,255,0);
				line(innerWidth/2,0,innerWidth/2,innerHeight);
				line(0,innerHeight/2,innerWidth,innerHeight/2);
				stroke(0,255,0);
				line(innerWidth/2-cord[0],0,innerWidth/2-cord[0],innerHeight);
				line(0,innerHeight/2+cord[1],innerWidth,innerHeight/2+cord[1]);
				textSize(innerWidth*0.016);
				stroke(255,255,255);
				text("["+cord[0]+", "+cord[1]+"]",innerWidth*0.01,innerHeight*0.05);
				text(round((cord[0]+mouseX)-innerWidth/2)+", "+round((cord[1]+mouseY)-innerHeight/2),innerWidth*0.01,innerHeight*0.10);
				text(performance.memory.usedJsHeapSize,innerWidth*0.8,innerHeight*0.25);
				element.show(["overlay_dev_map"])
			} else {element.hide(["overlay_dev_map"])}
			if(keyIsPressed){procKeys[key.toString()] = true}
			else{for(i in procKeys){procKeys[i] = false}}
			if(keyIsPressed && procKeys.a && procKeys.w && borders[0]+cord[0] > 1 && borders[1]+cord[1] < borders[1]*2){
				cord[0] -= settings.keySpeed;cord[1] += settings.keySpeed
			}
			else if(keyIsPressed && procKeys.a && procKeys.s && borders[0]+cord[0] > 1 && borders[1]+cord[1] > 0){
				cord[0] -= settings.keySpeed;cord[1] -= settings.keySpeed
			}
			else if(keyIsPressed && procKeys.d && procKeys.w && borders[0]+cord[0] < borders[0]*2 && borders[1]+cord[1] < borders[1]*2){
				cord[0] += settings.keySpeed;cord[1] += settings.keySpeed
			}
			else if(keyIsPressed && procKeys.d && procKeys.s && borders[0]+cord[0] < borders[0]*2 && borders[1]+cord[1] > 0){
				cord[0] += settings.keySpeed;cord[1] -= settings.keySpeed
			}
			else if(keyIsPressed &&	(procKeys.a||keyCode == LEFT) && borders[0]+cord[0] > 1){
				cord[0] -= settings.keySpeed
			}
			else if(keyIsPressed &&	(procKeys.d||keyCode == RIGHT) && borders[0]+cord[0] < borders[0]*2){
				cord[0] += settings.keySpeed
			}
			else if(keyIsPressed &&	(procKeys.w||keyCode == UP) && borders[1]+cord[1] < borders[1]*2){
				cord[1] += settings.keySpeed
			}
			else if(keyIsPressed && (procKeys.s||keyCode == DOWN) && borders[1]+cord[1] > 0){
				cord[1] -= settings.keySpeed
			}
		}
		if(view == "battle"){
			fill(255,255,255);
			noStroke();
			for(var i = 0; i < 32; i++){
				ellipse(star.x[i],star.y[i],star.size[i],star.size[i]);
			}
			ship.battle.active = true;
			object("",0, innerWidth*1.25,innerHeight*0.5,innerWidth,planet.color.r[planet.selected], planet.color.g[planet.selected], planet.color.b[planet.selected]);
			$("#scene_view-battle_content_svg_ship-health").attr("width",round(ship.total.health/(ship.frozen.health/(width*0.08))));
			$("#scene_view-battle_content_svg_ship-shields").attr("width",round(ship.total.shields/(ship.frozen.shields/(width*0.08))));
			$("#scene_view-battle_content_svg_enemy-health").attr("width",round(enemy.total.health[planet.selected]/(enemy.frozen.health[planet.selected]/(width*0.08))));
			$("#scene_view-battle_content_svg_enemy-shields").attr("width",round(enemy.total.shields[planet.selected]/(enemy.frozen.shields[planet.selected]/(width*0.08))));
			if(dev.mode == true){
				textAlign(LEFT,TOP);
				fill(255,255,255);
				element.show(["scene_view-battle_content_advanced"])
				$("#scene_view-battle_content_advanced_ship").html(round(ship.total.health)+"/"+round(ship.frozen.health)+" | "+round(ship.total.shields)+"/"+round(ship.frozen.shields));
				$("#scene_view-battle_content_advanced_enemy").html(round(enemy.total.health[planet.selected])+"/"+round(enemy.frozen.health[planet.selected])+" | "+round(enemy.total.shields[planet.selected])+"/"+round(enemy.frozen.shields[planet.selected]));
			}
			for(var i=0;i<ship.fleet.type.length;i++){
				var target = floor(random(0,enemy.fleet.type[planet.selected].length));
				if(ship.fleet.health[i] > 0){
					ship.fleet.reload[i]--;
					ship.draw(ship.fleet.type[i],ship.generic.x[i],ship.generic.y[i],"e");
					if(ship.fleet.reload[i] <= 0){
						var destinationX = floor(random(0,enemy.fleet.type[planet.selected].length));
						var destinationY = floor(random(0,enemy.fleet.type[planet.selected].length));
						ship.fleet.crit.random = random(0,100);
						if(ship.fleet.crit.random < ship.fleet.crit.chance){
							ship.fleet.crit.dmg = 1+ship.fleet.crit.damage/100;
							textSize(height/32);
							fill(255, 128, 16);
							if(dev.mode == true){
					text("Crit!",ship.generic.x[i]+ship.generic.width[ship.fleet.type[i]]/2,ship.generic.y[i]+ship.generic.height[ship.fleet.type[i]]/2);
							}
						}
						else{ship.fleet.crit.dmg = 1}
						stroke(0,255,255);
					line(ship.generic.x[i],ship.generic.y[i],enemy.generic.x[destinationX],enemy.generic.y[destinationY]);
						ship.fleet.reload[i] = ship.generic.reload[ship.fleet.type[i]];
						if(enemy.fleet.shields[planet.selected][target] < 1){
							enemy.fleet.health[planet.selected][target]-=ship.fleet.damage[i]/20*(ship.fleet.multiplyer.damage* ship.fleet.crit.dmg*(ship.fleet.level[ship.fleet.type[i]]+1));
						} else if (enemy.fleet.shields[planet.selected][target] > 0){
							enemy.fleet.shields[planet.selected][target]-=ship.fleet.damage[i]/20*(ship.fleet.multiplyer.damage* ship.fleet.crit.dmg*(ship.fleet.level[ship.fleet.type[i]]+1));
						}
					}
				} else {
					for(var s=0;s<ship.fleet.type.length;s++){
						if(s > i){
							ship.fleet.type[s-1] = ship.fleet.type[s];
							ship.fleet.health[s-1] = ship.fleet.health[s];
							ship.fleet.shields[s-1] = ship.fleet.shields[s];
							ship.fleet.damage[s-1] = ship.fleet.damage[s];
							ship.fleet.reload[s-1] = ship.fleet.reload[s];
						}
					}
				}
			}
			for(var i=0;i<enemy.fleet.type[planet.selected].length;i++){
				var target = floor(random(0,ship.fleet.type.length));
				if(enemy.fleet.health[planet.selected][i] > 0){
					ship.draw(enemy.fleet.type[planet.selected][i],enemy.generic.x[i],enemy.generic.y[i],"w");
					enemy.fleet.reload[planet.selected][i]--;
					if(enemy.fleet.reload[planet.selected][i] <= 0){
						var destinationX = floor(random(0,ship.fleet.type.length));
						var destinationY = floor(random(0,ship.fleet.type.length));
						stroke(255,0,0);
						line(enemy.generic.x[i], enemy.generic.y[i], ship.generic.x[destinationX], ship.generic.y[destinationY]);
						enemy.fleet.reload[planet.selected][i] = ship.generic.reload[enemy.fleet.type[planet.selected][i]];
						if(ship.fleet.shields[target] < 1){
							ship.fleet.health[target]-=enemy.fleet.damage[planet.selected][i]/20;
						} else if (ship.fleet.shields[target] > 0){
							ship.fleet.shields[target]-=enemy.fleet.damage[planet.selected][i]/20;
						}
					}
				}		
			}
			if(enemy.total.health[planet.selected] <= 0){
				planet.status[planet.selected] = 2;
				ship.battle.active = false;
				resource.metal+= 5000*planet.selected*resource.multiplyer;
				resource.minerals+= 2500*planet.selected*resource.multiplyer;
				resource.fuel+= 2000*planet.selected*resource.multiplyer;
				resource.random = random(0,100);
				if(resource.random < 5+tech.level.salvage){
					resource.ancient_tech+=planet.selected
				}
				if(resource.random > 95-tech.level.salvage){
					resource.code_snippets+=planet.selected
				}
				tech.points+= 4*planet.selected*resource.multiplyer;
				ship.battle.won=true;
				element.hide(["scene_view-battle"]);
				element.show(["scene_view-report","nav"]);
				view = "map"
			}
			if(ship.total.health <= 0){
				ship.battle.active = false;
				ship.battle.won=false;
				element.hide(["scene_view-battle"]);
				element.show(["scene_view-report","nav"]);
				view = "map"
			}
		}	
	};
}};
var processingInstance = new Processing($("#mycanvas")[0],sketch); 
	</script>
</html>